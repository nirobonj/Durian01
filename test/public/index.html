<!-- public/index.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Country Selector</title>
  </head>
  <body>
    <h1>Select a Country, State, and City</h1>
    <select id="countrySelector">
      <option value="">Select a country</option>
    </select>
    <select id="stateSelector">
      <option value="">Select a state</option>
    </select>
    <select id="citySelector">
      <option value="">Select a city</option>
    </select>
    <p id="selectedLocation"></p>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const countrySelector = document.getElementById("countrySelector");
        const stateSelector = document.getElementById("stateSelector");
        const citySelector = document.getElementById("citySelector");
        const selectedLocation = document.getElementById("selectedLocation");

        // Load countries
        fetch("/countries")
          .then((response) => response.json())
          .then((countries) => {
            countries.forEach((country) => {
              const option = document.createElement("option");
              option.value = country;
              option.textContent = country;
              countrySelector.appendChild(option);
            });
          });

        countrySelector.addEventListener("change", function () {
          stateSelector.innerHTML = '<option value="">Select a state</option>';
          citySelector.innerHTML = '<option value="">Select a city</option>';
          selectedLocation.textContent = "";
          if (countrySelector.value) {
            fetch(`/states/${countrySelector.value}`)
              .then((response) => response.json())
              .then((states) => {
                states.forEach((state) => {
                  const option = document.createElement("option");
                  option.value = state;
                  option.textContent = state;
                  stateSelector.appendChild(option);
                });
              });
          }
        });

        stateSelector.addEventListener("change", function () {
          citySelector.innerHTML = '<option value="">Select a city</option>';
          selectedLocation.textContent = "";
          if (stateSelector.value) {
            fetch(`/cities/${stateSelector.value}`)
              .then((response) => response.json())
              .then((cities) => {
                cities.forEach((city) => {
                  const option = document.createElement("option");
                  option.value = city;
                  option.textContent = city;
                  citySelector.appendChild(option);
                });
              });
          }
        });

        citySelector.addEventListener("change", function () {
          selectedLocation.textContent = `You selected: ${countrySelector.value}, ${stateSelector.value}, ${citySelector.value}`;
        });
      });
    </script>
  </body>
</html>
